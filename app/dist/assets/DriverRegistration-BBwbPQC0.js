import{t as J,u as H,_ as Q}from"./index-DaAC2zqA.js";import{r as n,j as e,b as I,a1 as U,J as G,n as z,a2 as K,a3 as X,a4 as Z,$ as ee}from"./react-vendor-JE9gdlBQ.js";import{d as te}from"./driver-ZL_jGIpG.js";import{b as ae}from"./vehicles-CkZMpXtf.js";import{d as se,a as ie,b as re,L as ne}from"./router-DL0rZlEF.js";import{u as le}from"./useFavicon-Bc8ZFvv0.js";import{S as oe}from"./StateAutocomplete-CLQ3OVdu.js";import"./utils-2shQNo7D.js";import"./vendor-C1Py2TwH.js";function xe(){var W,T;le();const[x,L]=n.useState(!1),[t,g]=n.useState({email:"",password:"",first_name:"",last_name:"",phone_no:"",state:"",postal_code:"",license_number:"",vehicle:{make:"",model:"",year:"",license_plate:"",color:"",vehicle_category:""}}),[v,B]=n.useState(!1),[b,_]=n.useState(!1),[F,d]=n.useState(""),[D,$]=n.useState([]),[P,C]=n.useState(!1),[f,E]=n.useState(null),[m,A]=n.useState("dark"),j=n.useRef(null),[Y]=se(),N=ie(),{tenantInfo:p,isLoading:V}=J(),y=((W=N.state)==null?void 0:W.token)||Y.get("token")||"",h=((T=N.state)==null?void 0:T.tenantId)||null,k=re(),{isAuthenticated:S,role:w}=H(),M=()=>{if(typeof window>"u")return"dark";const s=document.documentElement.getAttribute("data-theme")||document.body.getAttribute("data-theme");return s==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":s||"dark"};n.useEffect(()=>{const s=()=>{const i=M();A(i)};s();const r=new MutationObserver(s);r.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),r.observe(document.body,{attributes:!0,attributeFilter:["data-theme"]});const a=window.matchMedia("(prefers-color-scheme: dark)");return a.addEventListener("change",s),()=>{r.disconnect(),a.removeEventListener("change",s)}},[]),n.useEffect(()=>{const s=new IntersectionObserver(r=>{r.forEach(a=>{a.isIntersecting&&!f&&(Q(()=>import("./nikita-pishchugin-IdyI9y8BfB4-unsplash-CabSUqcr.js"),[]).then(i=>{E(i.default)}).catch(i=>{console.warn("Failed to load background image:",i)}),s.disconnect())})},{rootMargin:"50px"});return j.current&&s.observe(j.current),()=>{s.disconnect()}},[f]),n.useEffect(()=>{S&&w==="driver"&&k("/driver/dashboard",{replace:!0})},[S,w,k]),n.useEffect(()=>{y?h||d("Tenant ID is missing. Please verify your token again."):d("Verification token is required. Please use the verification link provided.")},[y,h]),n.useEffect(()=>{(async()=>{if(h)try{C(!0);const r=await ae(h);r.success&&r.data&&$(r.data)}catch(r){console.error("Failed to fetch vehicle categories:",r)}finally{C(!1)}})()},[h]);const q=s=>{const a=s.replace(/\D/g,"").slice(0,10);return a.length===0?"":a.length<=3?`(${a}`:a.length<=6?`(${a.slice(0,3)}) ${a.slice(3)}`:`(${a.slice(0,3)}) ${a.slice(3,6)}-${a.slice(6)}`},l=s=>{const{name:r,value:a}=s.target;if(r==="phone_no")g({...t,[r]:q(a)});else if(r.startsWith("vehicle.")){const i=r.split(".")[1];g({...t,vehicle:{...t.vehicle,[i]:a}})}else g({...t,[r]:a})},O=async s=>{var r;if(s.preventDefault(),!y){d("Verification token is required. Please use the verification link provided.");return}if(!h){d("Tenant ID is missing. Please verify your token again.");return}try{_(!0),d("");let a=t.phone_no.trim();if(a&&!a.startsWith("+")){const o=a.replace(/\D/g,"");o.length===10?a=`+1 (${o.slice(0,3)}) ${o.slice(3,6)}-${o.slice(6)}`:a=t.phone_no.trim()}const i={email:t.email.trim(),phone_no:a,first_name:t.first_name.trim(),last_name:t.last_name.trim(),password:t.password};if(t.state&&t.state.trim()&&(i.state=t.state.trim()),t.postal_code&&t.postal_code.trim()&&(i.postal_code=t.postal_code.trim()),t.license_number&&t.license_number.trim()&&(i.license_number=t.license_number.trim()),v&&t.vehicle.make&&t.vehicle.model){const o={make:t.vehicle.make.trim(),model:t.vehicle.model.trim(),status:"available",seating_capacity:4,vehicle_category:t.vehicle.vehicle_category&&t.vehicle.vehicle_category.trim()||"Standard"};if(t.vehicle.year&&t.vehicle.year.trim()){const c=parseInt(t.vehicle.year);isNaN(c)?o.year=new Date().getFullYear():o.year=c}else o.year=new Date().getFullYear();t.vehicle.license_plate&&t.vehicle.license_plate.trim()&&(o.license_plate=t.vehicle.license_plate.trim()),t.vehicle.color&&t.vehicle.color.trim()&&(o.color=t.vehicle.color.trim()),i.vehicle=o}else i.vehicle=null;console.log("Sending registration payload:",JSON.stringify(i,null,2)),await te(i,h),k("/driver/login",{replace:!0})}catch(a){if(console.error("Registration error:",a),(r=a.response)!=null&&r.data){const i=a.response.data;if(i.detail)if(Array.isArray(i.detail)){const o=i.detail.map(c=>{var R;return typeof c=="string"?c:c.msg?`${((R=c.loc)==null?void 0:R.join("."))||"Field"}: ${c.msg}`:JSON.stringify(c)}).join(`
`);d(o)}else d(i.detail);else i.message?d(i.message):d(`Registration failed: ${JSON.stringify(i)}`)}else d(a.message||"Registration failed. Please try again.")}finally{_(!1)}};if(S&&w==="driver")return null;if(V)return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"var(--bw-bg)"},children:e.jsx("div",{style:{color:"var(--bw-text)",fontFamily:"Work Sans, sans-serif",fontSize:"16px"},children:"Loading..."})});const u=(p==null?void 0:p.company_name)||"Our Service";return e.jsxs("main",{className:"bw","aria-label":"Driver Registration",style:{margin:0,padding:0,minHeight:"100vh",overflow:"auto"},children:[e.jsxs("div",{style:{display:"flex",minHeight:"100vh",width:"100%"},children:[e.jsxs("div",{ref:j,className:"driver-registration-image-container",style:{width:"60%",height:"100%",position:"relative",backgroundImage:f?`url(${f})`:"none",backgroundColor:f?"transparent":"#f3f4f6",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",transition:"background-image 0.3s ease",display:"flex",alignItems:"flex-start",justifyContent:"center",padding:"48px",paddingTop:"120px"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.6)",zIndex:1}}),e.jsx("div",{style:{color:"white",textAlign:"center",maxWidth:"600px",zIndex:2,position:"relative",padding:"32px"},children:e.jsxs("p",{style:{fontFamily:"Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",fontSize:"20px",lineHeight:"1.6",fontWeight:300,textShadow:"0 2px 8px rgba(0, 0, 0, 0.5)",margin:0},children:["Join ",u,"'s team of drivers. Create your account to start accepting rides and managing your driver profile."]})})]}),e.jsx("div",{role:"form","aria-labelledby":"registration-title",className:"driver-registration-form-container",style:{width:"40%",minHeight:"100vh",position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"24px",paddingTop:"clamp(24px, 5vw, 48px)",backgroundColor:"var(--bw-bg)",overflowY:"auto"},children:e.jsxs("div",{style:{width:"100%",maxWidth:"100%"},children:[p&&e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center",alignItems:"center"},children:p.logo_url?e.jsx("img",{src:p.logo_url,alt:u,style:{maxHeight:"60px",maxWidth:"200px",objectFit:"contain"}}):e.jsx("h1",{style:{margin:0,fontSize:"32px",fontWeight:600,color:"var(--bw-text)",fontFamily:"DM Sans, sans-serif"},children:u})}),e.jsx("h2",{id:"registration-title",style:{margin:0,fontSize:40,fontFamily:"DM Sans, sans-serif",fontWeight:200},children:"Create account"}),e.jsx("p",{className:"small-muted",style:{marginTop:6,fontSize:16,fontFamily:"Work Sans, sans-serif",fontWeight:300},children:p?`Sign up to drive for ${u}`:"Sign up to get started"}),F&&e.jsx("div",{style:{marginTop:16,padding:"12px",backgroundColor:"rgba(197, 72, 61, 0.1)",border:"1px solid var(--bw-error)",borderRadius:"4px",color:"var(--bw-error)",fontSize:"14px",fontFamily:"Work Sans, sans-serif",width:"100%"},children:F}),e.jsxs("form",{onSubmit:O,style:{marginTop:16,width:"100%"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsx("label",{className:"small-muted",htmlFor:"first_name",style:{fontFamily:"Work Sans, sans-serif"},children:"First name"}),e.jsx("label",{className:"small-muted",htmlFor:"last_name",style:{fontFamily:"Work Sans, sans-serif"},children:"Last name"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(I,{size:16,"aria-hidden":!0,style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",opacity:.7,color:m==="dark"?"#ffffff":void 0}}),e.jsx("input",{id:"first_name",name:"first_name",type:"text",required:!0,className:"bw-input",style:{padding:"16px 18px 16px 44px",borderRadius:0,fontFamily:"Work Sans, sans-serif"},placeholder:"John",value:t.first_name,onChange:l})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(I,{size:16,"aria-hidden":!0,style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",opacity:.7,color:m==="dark"?"#ffffff":void 0}}),e.jsx("input",{id:"last_name",name:"last_name",type:"text",required:!0,className:"bw-input",style:{padding:"16px 18px 16px 44px",borderRadius:0,fontFamily:"Work Sans, sans-serif"},placeholder:"Doe",value:t.last_name,onChange:l})]})]}),e.jsx("label",{className:"small-muted",htmlFor:"email",style:{fontFamily:"Work Sans, sans-serif"},children:"Email"}),e.jsxs("div",{style:{position:"relative",marginTop:6,marginBottom:12},children:[e.jsx(U,{size:16,"aria-hidden":!0,style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",opacity:.7,color:m==="dark"?"#ffffff":void 0}}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,className:"bw-input",style:{padding:"16px 18px 16px 44px",borderRadius:0,fontFamily:"Work Sans, sans-serif"},placeholder:"you@email.com",value:t.email,onChange:l})]}),e.jsx("label",{className:"small-muted",htmlFor:"phone_no",style:{fontFamily:"Work Sans, sans-serif"},children:"Phone number"}),e.jsxs("div",{style:{position:"relative",marginTop:6,marginBottom:12},children:[e.jsx(G,{size:16,"aria-hidden":!0,style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",opacity:.7,color:m==="dark"?"#ffffff":void 0}}),e.jsx("input",{id:"phone_no",name:"phone_no",type:"tel",required:!0,className:"bw-input",style:{padding:"16px 18px 16px 44px",borderRadius:0,fontFamily:"Work Sans, sans-serif"},placeholder:"(555) 555-5555",value:t.phone_no,onChange:l,maxLength:14})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsx("label",{className:"small-muted",htmlFor:"state",style:{fontFamily:"Work Sans, sans-serif"},children:"State"}),e.jsx("label",{className:"small-muted",htmlFor:"postal_code",style:{fontFamily:"Work Sans, sans-serif"},children:"Postal code"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsx(oe,{value:t.state,onChange:s=>g({...t,state:s}),placeholder:"NY",className:"bw-input",style:{padding:"16px 18px",borderRadius:0}}),e.jsx("input",{id:"postal_code",name:"postal_code",type:"text",className:"bw-input",style:{padding:"16px 18px",borderRadius:0,fontFamily:"Work Sans, sans-serif"},placeholder:"10001",value:t.postal_code,onChange:l,maxLength:5})]}),e.jsx("label",{className:"small-muted",htmlFor:"license_number",style:{fontFamily:"Work Sans, sans-serif"},children:"License number"}),e.jsx("div",{style:{position:"relative",marginTop:6,marginBottom:12},children:e.jsx("input",{id:"license_number",name:"license_number",type:"text",className:"bw-input",style:{padding:"16px 18px",borderRadius:0,fontFamily:"Work Sans, sans-serif"},placeholder:"License number",value:t.license_number,onChange:l,maxLength:12})}),e.jsxs("div",{style:{marginTop:24,marginBottom:12,padding:"16px",border:"1px solid var(--bw-border)",borderRadius:"8px",backgroundColor:"var(--bw-bg)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[e.jsx("input",{type:"checkbox",id:"includeVehicle",checked:v,onChange:s=>B(s.target.checked),style:{cursor:"pointer"}}),e.jsx("label",{htmlFor:"includeVehicle",style:{fontFamily:"Work Sans, sans-serif",fontSize:"14px",color:"var(--bw-text)",cursor:"pointer"},children:"I have a vehicle to add (outsourced driver)"})]}),v&&e.jsxs("div",{style:{marginTop:12},children:[e.jsxs("p",{style:{fontSize:"12px",color:"var(--bw-text)",opacity:.7,marginBottom:12,fontFamily:"Work Sans, sans-serif"},children:["If you have a vehicle you want to add, please contact ",u," to add it to your account."]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsx("label",{className:"small-muted",htmlFor:"vehicle.make",style:{fontFamily:"Work Sans, sans-serif"},children:"Make"}),e.jsx("label",{className:"small-muted",htmlFor:"vehicle.model",style:{fontFamily:"Work Sans, sans-serif"},children:"Model"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(z,{size:16,"aria-hidden":!0,style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",opacity:.7,color:m==="dark"?"#ffffff":void 0}}),e.jsx("input",{id:"vehicle.make",name:"vehicle.make",type:"text",className:"bw-input",style:{padding:"16px 18px 16px 44px",borderRadius:0,fontFamily:"Work Sans, sans-serif"},placeholder:"Toyota",value:t.vehicle.make,onChange:l})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(z,{size:16,"aria-hidden":!0,style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",opacity:.7,color:m==="dark"?"#ffffff":void 0}}),e.jsx("input",{id:"vehicle.model",name:"vehicle.model",type:"text",className:"bw-input",style:{padding:"16px 18px 16px 44px",borderRadius:0,fontFamily:"Work Sans, sans-serif"},placeholder:"Camry",value:t.vehicle.model,onChange:l})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("label",{className:"small-muted",htmlFor:"vehicle.year",style:{fontFamily:"Work Sans, sans-serif"},children:"Year"}),e.jsx("input",{id:"vehicle.year",name:"vehicle.year",type:"number",className:"bw-input",style:{padding:"16px 18px",borderRadius:0,fontFamily:"Work Sans, sans-serif",marginTop:6},placeholder:"2020",value:t.vehicle.year,onChange:l,maxLength:4})]}),e.jsxs("div",{children:[e.jsx("label",{className:"small-muted",htmlFor:"vehicle.license_plate",style:{fontFamily:"Work Sans, sans-serif"},children:"License Plate"}),e.jsx("input",{id:"vehicle.license_plate",name:"vehicle.license_plate",type:"text",className:"bw-input",style:{padding:"16px 18px",borderRadius:0,fontFamily:"Work Sans, sans-serif",marginTop:6},placeholder:"ABC123",value:t.vehicle.license_plate,onChange:l,maxLength:8})]}),e.jsxs("div",{children:[e.jsx("label",{className:"small-muted",htmlFor:"vehicle.color",style:{fontFamily:"Work Sans, sans-serif"},children:"Color"}),e.jsx("input",{id:"vehicle.color",name:"vehicle.color",type:"text",className:"bw-input",style:{padding:"16px 18px",borderRadius:0,fontFamily:"Work Sans, sans-serif",marginTop:6},placeholder:"Black",value:t.vehicle.color,onChange:l})]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("label",{className:"small-muted",htmlFor:"vehicle.vehicle_category",style:{fontFamily:"Work Sans, sans-serif"},children:"Vehicle Category"}),e.jsxs("select",{id:"vehicle.vehicle_category",name:"vehicle.vehicle_category",className:"bw-input",style:{padding:"16px 18px",borderRadius:0,fontFamily:"Work Sans, sans-serif",marginTop:6,width:"100%",boxSizing:"border-box"},value:t.vehicle.vehicle_category,onChange:l,disabled:P,children:[e.jsx("option",{value:"",children:"Select vehicle category"}),D.map(s=>e.jsx("option",{value:s.vehicle_category,children:s.vehicle_category},s.id))]})]})]})]}),e.jsx("label",{className:"small-muted",htmlFor:"password",style:{fontFamily:"Work Sans, sans-serif"},children:"Password"}),e.jsxs("div",{style:{position:"relative",marginTop:6},children:[e.jsx(K,{size:16,"aria-hidden":!0,style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",opacity:.7,color:m==="dark"?"#ffffff":void 0}}),e.jsx("input",{id:"password",name:"password",type:x?"text":"password",required:!0,className:"bw-input",style:{padding:"16px 18px 16px 44px",borderRadius:0,fontFamily:"Work Sans, sans-serif"},placeholder:"••••••••",value:t.password,onChange:l}),e.jsx("button",{type:"button","aria-label":"Toggle password",onClick:()=>L(!x),style:{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",background:"transparent",border:0,color:m==="dark"?"#ffffff":"#4c4e4eff",cursor:"pointer"},children:x?e.jsx(X,{size:16}):e.jsx(Z,{size:16})})]}),e.jsxs("button",{className:"bw-btn",style:{width:"100%",marginTop:16,borderRadius:0,padding:"14px 24px",fontFamily:"Work Sans, sans-serif",fontWeight:500},disabled:b||!y,type:"submit",children:[e.jsx("span",{children:b?"Creating account...":"Create account"}),!b&&e.jsx(ee,{size:16,"aria-hidden":!0})]}),e.jsxs("div",{style:{marginTop:24,width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:16,gap:12},children:[e.jsx("div",{style:{flex:1,height:"1px",backgroundColor:"var(--bw-border)"}}),e.jsx("span",{className:"small-muted",style:{fontSize:"12px",fontFamily:"Work Sans, sans-serif"},children:"or"}),e.jsx("div",{style:{flex:1,height:"1px",backgroundColor:"var(--bw-border)"}})]}),e.jsxs("p",{className:"small-muted",style:{textAlign:"center",marginBottom:16,fontSize:"14px",fontFamily:"Work Sans, sans-serif"},children:["Already have an account?"," ",e.jsx(ne,{to:"/driver/login",style:{color:"var(--bw-fg)",textDecoration:"underline"},children:"signin"})]})]})]})]})})]}),e.jsx("style",{children:`
        @media (max-width: 768px) {
          .driver-registration-image-container {
            display: none !important;
          }
          .driver-registration-form-container {
            width: 100% !important;
          }
        }
      `})]})}export{xe as default};
